以下是一个使用 PHP 代码实现检测爬虫和爬虫来源的示例：

```php
// 获取用户代理
$user_agent = $_SERVER['HTTP_USER_AGENT'];

// 检查用户代理中是否包含爬虫关键词
if (strpos($user_agent, 'bot') !== false || strpos($user_agent, 'crawler') !== false || strpos($user_agent, 'spider') !== false) {
    // 如果包含爬虫关键词，则认为是爬虫访问
    echo "This is a crawler";

    // 获取访问者的 IP 地址
    $ip_address = $_SERVER['REMOTE_ADDR'];

    // 使用 IP 地址库查找该 IP 地址是否属于已知的爬虫
    $is_known_crawler = check_ip_address($ip_address);

    if ($is_known_crawler) {
    // 如果该 IP 地址属于已知的爬虫，则记录爬虫来源
    echo "Crawler source: " . $is_known_crawler;
    }
}

// 检查访问频率
$last_request_time = $_SESSION['last_request_time'];
$current_request_time = $_SERVER['REQUEST_TIME'];

if ($current_request_time - $last_request_time < 1) {
    // 如果两次请求之间的时间差小于 1 秒，则认为是爬虫访问
    echo "This is a crawler";
}

// 获取 HTTP 头信息
$headers = get_headers('http://example.com');

// 检查 HTTP 头信息中是否包含爬虫关键词或者标识符
foreach ($headers as $header) {
    if (strpos($header, 'bot') !== false || strpos($header, 'crawler') !== false || strpos($header, 'spider') !== false) {
        // 如果包含爬虫关键词或者标识符，则认为是爬虫访问
        echo "This is a crawler";
    }
}
```

请注意，上述代码只是一个示例，您需要根据您的具体业务需求和网站特点进行相应的修改和优化。例如，您可以使用更高级的 IP 地址库来提高检测准确度，或者使用更复杂的算法来检测访问频率等。